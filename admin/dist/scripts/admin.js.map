{"version":3,"sources":["../assets/scripts/admin/upload.js","../assets/scripts/admin.js"],"names":["$","window","fn","wp_editor","opts","this","is","console","warn","tinyMCEPreInit","QTags","wizhi_vars","default_options","mode","mceInit","theme","skin","language","formats","alignleft","selector","styles","textAlign","deep","remove","classes","aligncenter","alignright","strikethrough","inline","split","relative_urls","remove_script_host","convert_urls","browser_spellcheck","fix_list_elements","entities","entity_encoding","keep_styles","paste_webkit_styles","preview_styles","wpeditimage_disable_captions","wpeditimage_html5_captions","plugins","content_css","includes_url","cms_url","wp_lang_attr","resize","menubar","wpautop","indent","toolbar1","toolbar2","toolbar3","toolbar4","tabfocus_elements","body_class","wp_autoresize_on","id_regexp","RegExp","options","extend","each","current_id","attr","key","value","type","replace","addClass","show","self","closest","length","parent_el","parent","before","clone","find","wrap","editor_tools","editor_tabs","switch_editor_html","switch_editor_tmce","media_buttons","insert_media_button","editor_container","appendTo","append","_buttonsInit","switchEditors","go","on","event","elem","currentTarget","editor","data","frame","state","title","wp","media","view","l10n","addMedia","multiple","preventDefault","blur","hasClass","createGalleryTitle","open","jQuery","document","ready","row","insertAfter","_custom_media","_orig_send_attachment","send","attachment","click","e","button","props","val","url","apply","modal","parents","tabContainer","siblings","hide","removeClass"],"mappings":"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","file":"admin.js","sourcesContent":["/*\n *\tJavaScript Wordpress editor\n *\tAuthor: \t\tAnte Primorac\n *\tAuthor URI: \thttp://anteprimorac.from.hr\n *\tVersion: \t\t1.1\n */\n\n\n;(function ($, window) {\n    $.fn.wp_editor = function (opts) {\n\n        if (!$(this).is('textarea')) {\n            console.warn('Element must be a textarea');\n        }\n\n        if (typeof tinyMCEPreInit == 'undefined' || typeof QTags == 'undefined' || typeof wizhi_vars == 'undefined') {\n            console.warn('js_wp_editor( $settings ); must be loaded');\n        }\n\n        if (!$(this).is('textarea') || typeof tinyMCEPreInit == 'undefined' || typeof QTags == 'undefined' || typeof wizhi_vars == 'undefined') {\n            return this;\n        }\n\n\n        // 默认设置选项\n        var default_options = {\n            'mode': 'tmce',\n            'mceInit': {\n                \"theme\": \"modern\",\n                \"skin\": \"lightgray\",\n                \"language\": \"zh\",\n                \"formats\": {\n                    \"alignleft\": [{\n                        \"selector\": \"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li\",\n                        \"styles\": {\"textAlign\": \"left\"},\n                        \"deep\": false,\n                        \"remove\": \"none\"\n                    },\n                        {\n                            \"selector\": \"img,table,dl.wp-caption\",\n                            \"classes\": [\"alignleft\"],\n                            \"deep\": false,\n                            \"remove\": \"none\"\n                        }],\n                    \"aligncenter\": [{\n                        \"selector\": \"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li\",\n                        \"styles\": {\"textAlign\": \"center\"},\n                        \"deep\": false,\n                        \"remove\": \"none\"\n                    },\n                        {\n                            \"selector\": \"img,table,dl.wp-caption\",\n                            \"classes\": [\"aligncenter\"],\n                            \"deep\": false,\n                            \"remove\": \"none\"\n                        }],\n                    \"alignright\": [{\n                        \"selector\": \"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li\",\n                        \"styles\": {\"textAlign\": \"right\"},\n                        \"deep\": false,\n                        \"remove\": \"none\"\n                    },\n                        {\n                            \"selector\": \"img,table,dl.wp-caption\",\n                            \"classes\": [\"alignright\"],\n                            \"deep\": false,\n                            \"remove\": \"none\"\n                        }],\n                    \"strikethrough\": {\n                        \"inline\": \"del\",\n                        \"deep\": true,\n                        \"split\": true\n                    }\n                },\n                \"relative_urls\": false,\n                \"remove_script_host\": false,\n                \"convert_urls\": false,\n                \"browser_spellcheck\": true,\n                \"fix_list_elements\": true,\n                \"entities\": \"38,amp,60,lt,62,gt\",\n                \"entity_encoding\": \"raw\",\n                \"keep_styles\": false,\n                \"paste_webkit_styles\": \"font-weight font-style color\",\n                \"preview_styles\": \"font-family font-size font-weight font-style text-decoration text-transform\",\n                \"wpeditimage_disable_captions\": false,\n                \"wpeditimage_html5_captions\": false,\n                \"plugins\": \"charmap,hr,media,paste,tabfocus,textcolor,fullscreen,wordpress,wpautoresize,wpemoji,wpeditimage,wpgallery,wptextpattern,wplink,wpdialogs,wpview,image,wpembed\",\n                \"content_css\": wizhi_vars.includes_url + \"css/dashicons.css,\" + wizhi_vars.includes_url + \"js/mediaelement/mediaelementplayer.min.css,\" + wizhi_vars.includes_url + \"js/mediaelement/wp-mediaelement.css,\" + wizhi_vars.includes_url + \"js/tinymce/skins/wordpress/wp-content.css,\" + wizhi_vars.cms_url + \"/wizhi-cms/front/dist/styles/main.css,\" + wizhi_vars.cms_url + \"/wizhi-cms/admin/dist/styles/main.css\",\n                \"wp_lang_attr\": \"zh-CN\",\n                \"selector\": \"#wid\",\n                \"resize\": \"vertical\",\n                \"menubar\": false,\n                \"wpautop\": true,\n                \"indent\": false,\n                \"toolbar1\": \"bold,italic,strikethrough,bullist,numlist,blockquote,hr,alignleft,aligncenter,alignright,link,unlink,wp_more,spellchecker,fullscreen,wp_adv\",\n                \"toolbar2\": \"formatselect,underline,alignjustify,forecolor,pastetext,removeformat,charmap,outdent,indent,undo,redo,wp_help\",\n                \"toolbar3\": \"\",\n                \"toolbar4\": \"\",\n                \"tabfocus_elements\": \":prev,:next\",\n                \"body_class\": \"typo wizhi wid\",\n                wp_autoresize_on: true\n            }\n        }, id_regexp = new RegExp('wid', 'g');\n\n        if (tinyMCEPreInit.mceInit['wid']) {\n            default_options.mceInit = tinyMCEPreInit.mceInit['wid'];\n        }\n\n        var options = $.extend(true, default_options, opts);\n\n\n        // 初始化可视化编辑器\n        return this.each(function () {\n\n            if (!$(this).is('textarea')) {\n                console.warn('Element must be a textarea');\n            } else {\n                var current_id = $(this).attr('id');\n                $.each(options.mceInit, function (key, value) {\n                    if ($.type(value) == 'string') {\n                        options.mceInit[key] = value.replace(id_regexp, current_id);\n                    }\n                });\n                options.mode = options.mode == 'tmce' ? 'tmce' : 'html';\n\n                tinyMCEPreInit.mceInit[current_id] = options.mceInit;\n\n                $(this).addClass('wp-editor-area').show();\n                var self = this;\n                if ($(this).closest('.wp-editor-wrap').length) {\n                    var parent_el = $(this).closest('.wp-editor-wrap').parent();\n                    $(this).closest('.wp-editor-wrap').before($(this).clone());\n                    $(this).closest('.wp-editor-wrap').remove();\n                    self = parent_el.find('textarea[id=\"' + current_id + '\"]');\n                }\n\n                var wrap = $('<div id=\"wp-' + current_id + '-wrap\" class=\"wp-core-ui wp-editor-wrap ' + options.mode + '-active\" />');\n                var editor_tools = $('<div id=\"wp-' + current_id + '-editor-tools\" class=\"wp-editor-tools hide-if-no-js\" />');\n                var editor_tabs = $('<div class=\"wp-editor-tabs\" />');\n                var switch_editor_html = $('<a id=\"' + current_id + '-html\" class=\"wp-switch-editor switch-html\" data-wp-editor-id=\"' + current_id + '\">Text</a>');\n                var switch_editor_tmce = $('<a id=\"' + current_id + '-tmce\" class=\"wp-switch-editor switch-tmce\" data-wp-editor-id=\"' + current_id + '\">Visual</a>');\n                var media_buttons = $('<div id=\"wp-' + current_id + '-media-buttons\" class=\"wp-media-buttons\" />');\n                var insert_media_button = $('<a href=\"#\" id=\"insert-media-button\" class=\"button insert-media add_media\" data-editor=\"' + current_id + '\" title=\"Add Media\"><span class=\"wp-media-buttons-icon\"></span> Add Media</a>'), editor_container = $('<div id=\"wp-' + current_id + '-editor-container\" class=\"wp-editor-container\" />');\n                var content_css = false;\n\n                insert_media_button.appendTo(media_buttons);\n                media_buttons.appendTo(editor_tools);\n\n                switch_editor_html.appendTo(editor_tabs);\n                switch_editor_tmce.appendTo(editor_tabs);\n                editor_tabs.appendTo(editor_tools);\n\n                editor_tools.appendTo(wrap);\n                editor_container.appendTo(wrap);\n\n                editor_container.append($(self).clone().addClass('wp-editor-area'));\n\n\n                // 内容样式\n                if (content_css != false) {\n                    $.each(content_css, function () {\n                        if (!$('link[href=\"' + this + '\"]').length) {\n                            $(self).before('<link rel=\"stylesheet\" type=\"text/css\" href=\"' + this + '\">');\n                        }\n                    });\n                }\n\n                $(self)\n                    .before('<link rel=\"stylesheet\" id=\"editor-buttons-css\" href=\"' + wizhi_vars.includes_url + '/css/editor.css\" type=\"text/css\" media=\"all\">');\n\n                $(self).before(wrap);\n                $(self).remove();\n\n\n                // 快捷按钮\n                new QTags(current_id);\n                QTags._buttonsInit();\n                switchEditors.go(current_id, options.mode);\n\n                // 插入媒体\n                $(wrap).on('click', '.insert-media', function (event) {\n                    var elem = $(event.currentTarget), editor = elem.data('editor'), options = {\n                        frame: 'post',\n                        state: 'insert',\n                        title: wp.media.view.l10n.addMedia,\n                        multiple: true\n                    };\n\n                    event.preventDefault();\n\n                    elem.blur();\n\n                    if (elem.hasClass('gallery')) {\n                        options.state = 'gallery';\n                        options.title = wp.media.view.l10n.createGalleryTitle;\n                    }\n\n                    wp.media.editor.open(editor, options);\n                });\n            }\n        });\n    }\n})(jQuery, window);\n\n\njQuery(document).ready(function ($) {\n\n    $('.tinymce').wp_editor();\n\n    $('#frm-abdesc').wp_editor();\n    $('#frm-abc').wp_editor();\n\n    // ---------------------------------------------------------\n    // 添加更多, 用于重复字段\n    // ---------------------------------------------------------\n    $('.add-row').on('click', function () {\n        var row = $(this).parent().find('input:last').clone(true);\n        row.addClass('new-row');\n        row.insertAfter($(this).parent().find('input:last'));\n        return false;\n    });\n\n    // 移除添加的元素\n    $('.remove-row').on('click', function () {\n        $(this).parent().find('input:last').remove();\n        return false;\n    });\n\n\n    // ---------------------------------------------------------\n    // 文件上传, 目前插入 URL, 考虑做成插入 ID的方式, 方便获取缩略图\n    // ---------------------------------------------------------\n    var _custom_media = true, _orig_send_attachment = wp.media.editor.send.attachment;\n\n    $('.wizhi_upload_button').click(function (e) {\n        var send_attachment_bkp = wp.media.editor.send.attachment;\n        var button = $(this);\n        _custom_media = true;\n        wp.media.editor.send.attachment = function (props, attachment) {\n            if (_custom_media) {\n                button.parent().parent().find('input[type=text]').val(attachment.url);\n            } else {\n                return _orig_send_attachment.apply(this, [props,\n                    attachment]);\n            }\n        };\n\n        wp.media.editor.open(button);\n        return false;\n    });\n\n    $('.add_media').on('click', function () {\n        _custom_media = false;\n    });\n\n});\n","jQuery(document).ready(function ($) {\n\n    // ---------------------------------------------------------\n    // 选项卡\n    // ---------------------------------------------------------\n    $('body').on('click', '.wizhi_modal_tab[data-for]', function () {\n        var modal = $(this).parents('.mce-container:eq(0)');\n        var tabContainer = $(this).parents('.wizhi_modal_tabs:eq(0)');\n        tabContainer.siblings().hide();\n        modal.find('#' + $(this).attr('data-for')).show();\n        tabContainer.find('.wizhi_modal_tab').removeClass('active');\n        $(this).addClass('active');\n    });\n\n\n    // Change the data-shortcode to remove the click handler\n    $('body').on('hover', '.shortcode-list-item[data-shortcode=\"wizhi_get_more_shortcodes\"]', function (e) {\n        $(this).attr('data-shortcode', '__wizhi_get_more_shortcodes');\n    });\n\n    // ---------------------------------------------------------\n    // 结束功能\n    // ---------------------------------------------------------\n\n});\n"],"sourceRoot":"assets/scripts/"}